# Сервис для работы с ПВЗ

## Краткое описание проекта

Сервис предназначен для управления пунктами выдачи заказов (ПВЗ) маркетплейса Авито. Он позволяет:

- Создавать и управлять ПВЗ в разрешённых городах (Москва, СПб, Казань)
- Организовывать процесс приёмки товаров
- Управлять статусами приёмок
- Добавлять и удалять товары по принципу LIFO

## Основные компоненты

### 1. База данных

Реализована на PostgreSQL с 4 основными таблицами:

- users - хранение данных пользователей и их ролей
- pickup_points - информация о ПВЗ
- receptions - данные о приёмках товаров
- goods - информация о принятых товарах

### 2. Слои приложения

- **Domain** - содержит бизнес-модели:
  - Пользователи
  - Пункты выдачи
  - Приёмки товаров
  - Товары

- **Repository** - слой работы с БД:
  - Создание ПВЗ с проверкой города
  - Управление приёмками
  - Работа с товарами

- **Service** - бизнес-логика:
  - Проверка условий для создания ПВЗ
  - Контроль состояния приёмок
  - Валидация операций

- **Transport** - HTTP-обработчики:
  - REST API для управления ПВЗ
  - Middleware для авторизации
  - Обработка запросов и ошибок

### 3. API

Основные эндпоинты:

- Создание ПВЗ (только для модераторов)
- Инициация приёмки товаров
- Добавление/удаление товаров
- Закрытие приёмки

## Тестирование

Реализован интеграционный тест, проверяющий полный цикл работы:

1. Создание ПВЗ
2. Открытие приёмки
3. Добавление 50 товаров
4. Закрытие приёмки
5. Проверка результатов

## Запуск

### Требования:

- Установленный PostgreSQL
- Go 1.21+

### Порядок запуска:

1. Настроить подключение к БД
2. Выполнить миграции
3. Запустить сервер: go run cmd/server/main.go

Сервис запускается на порту 8080 и готов к обработке запросов.
